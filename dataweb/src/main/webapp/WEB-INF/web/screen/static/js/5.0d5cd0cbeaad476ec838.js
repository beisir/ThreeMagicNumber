webpackJsonp([5],{106:function(t,e,n){var i=n(12)(n(195),n(220),null,null);t.exports=i.exports},186:function(t,e,n){t.exports={default:n(187),__esModule:!0}},187:function(t,e,n){n(189),t.exports=n(3).Object.keys},188:function(t,e,n){var i=n(8),a=n(3),r=n(21);t.exports=function(t,e){var n=(a.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*r(function(){n(1)}),"Object",s)}},189:function(t,e,n){var i=n(42),a=n(41);n(188)("keys",function(){return function(t){return a(i(t))}})},190:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(104),a=n.n(i),r=n(103),s=n.n(r),o=n(186),l=n.n(o);e.default={name:"chart-tendency",props:{chartTitle:{default:function(){return"趋势图"}},isShow:{default:function(){return!1}},navigation:{default:function(){return[]}},enums:{default:function(){return{timelimit:{today:{name:"今天",code:"0"},lastsevensays:{name:"最近七天",code:"1"},lastmonth:{name:"最近一个月",code:"2"},thismonth:{name:"本月数据",code:"8"},all:{name:"累计",code:"3"},weekly:{name:"周度数据",code:"4"},monthly:{name:"月度数据",code:"5"},Splitbyfinancial:{name:"按财务拆分",code:"6"},Splitbysalesorder:{name:"按销售订单拆分",code:"7"},numberPeople:{name:"按竞价人数排序",code:"10"},price:{name:"按竞价价格排序",code:"11"}}}}},service:{default:function(){return{url:""}}},chartOptions:{default:function(){return{title:{text:null},chart:{type:"spline"},colors:["#19c6Ed","#FF7C4D","#2BCC6B","#C275DF"],credits:{enabled:!1},tooltip:{formatter:null,shared:!0}}}},timermillisec:{default:function(){return 66e4}},chartEntityConstructor:{default:function(){return Highcharts.chart}},resetYAxisBeforeRedraw:{default:function(){return!0}},resetSeriesBeforeRedraw:{default:function(){return!0}}},data:function(){var t=this;t.navigation.forEach(function(e,n){e.filterEntities={};var i=(e.filters||{}).timelimit,a=t.enums.timelimit;a&&i&&(e.filterEntities.timelimit=(i||[]).map(function(t,e){if(a[t])return a[t]}))});var e=t.navigation;return l()(t.$privileges.mapping).length&&(e=e.filter(function(e){return t.$privileges.user[(t.$privileges.mapping[e.name]||{}).id]})||[]),{Navigation:e,CurrentNavigation:e[0]||{filterEntities:{}},CurrentTimelimitFilter:(((e[0]||{}).filterEntities||{}).timelimit||[])[0]||{},chartEntity:null,renderTimer:null,swiperOption:{slidesPerView:"auto",freeMode:!0}}},mounted:function(){var t=this;(t.Navigation.length>0||t.isShow)&&(setTimeout(function(){t.render()}),t.timermillisec&&(t.renderTimer=window.setInterval(function(){t.render()},t.timermillisec)))},beforeDestroy:function(){var t=this;window.clearInterval(t.renderTimer)},methods:{render:function(){var t=this,e=t.getData(),n=s()({},t.chartOptions);t.$emit("beforeRender",n),t.chartEntity?t.chartEntity.update(n,!1):t.chartEntity=new t.chartEntityConstructor(t.$refs.chartContainer,n),e.then(function(e){for(;t.resetYAxisBeforeRedraw&&t.chartEntity.yAxis.length>0;)t.chartEntity.yAxis[0].remove(!1);for(;t.resetSeriesBeforeRedraw&&t.chartEntity.series.length>0;)t.chartEntity.series[0].remove(!1);t.$emit("dataReady",e),(e.dataList||[]).forEach(function(i,a){t.chartEntity.addAxis({title:{text:null},labels:{format:"{value}"+i.unit,style:{color:n.colors[a]}},opposite:a%2==1},!1,!1),t.chartEntity.addSeries({name:i.name,marker:{enabled:!1},visible:i.isShow,data:i.data,tooltip:{valueSuffix:i.unit},yAxis:a},!1),t.chartEntity.xAxis[0].update({categories:e.time},!1)}),t.$emit("beforeRedraw",t.chartEntity),t.chartEntity.redraw()}),t.$emit("afterRender",t.chartEntity)},getData:function(){var t=this,e={url:t.service.url,params:s()({},t.service.params,{type:t.CurrentNavigation.code,time:t.CurrentTimelimitFilter.code})};return t.$emit("beforeGetData",e),e.promise?e.promise:new a.a(function(n,i){t.$http.get(e.url,{params:e.params}).then(function(e){if(e=e.body||{},0!==parseInt(e.errno))return console.warn("返回数据状态码错误！"),void i(e);t.$emit("afterGetData",e),n(e.data||{})},function(t){console.warn("获取数据请求失败！"),i(t)})})},switchNav:function(t){var e=this;e.CurrentNavigation=t,e.CurrentTimelimitFilter=(e.CurrentNavigation.filterEntities.timelimit||[])[0]||{},e.$emit("navigationSwitched",this),e.render()},switchTimelimitFilter:function(t){var e=this;e.CurrentTimelimitFilter=t,e.$emit("timelimitFilterSwitched",this),e.render()},isActiveNav:function(t){return this.CurrentNavigation.code===t.code},isActiveTimelimitFilter:function(t){return this.CurrentTimelimitFilter.code===t.code}}}},191:function(t,e,n){var i=n(12)(n(190),n(192),null,null);t.exports=i.exports},192:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.Navigation.length>0||t.isShow,expression:"Navigation.length>0||isShow"}],staticClass:"panel panel-default hour-trend"},[n("nav",{staticClass:"navbar navbar-default",staticStyle:{background:"#f5f5f5","margin-top":"30px","margin-bottom":"10px"},attrs:{role:"navigation"}},[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"navbar-header"},[n("span",{staticClass:"navbar-brand",staticStyle:{"font-size":"16px"}},[t._v("\n                    "+t._s(t.chartTitle)+"\n                ")])]),t._v(" "),n("div",{attrs:{id:"titleHead"}},[n("swiper",{attrs:{options:t.swiperOption}},t._l(t.Navigation,function(e){return n("swiper-slide",[n("span",{class:{active:t.isActiveNav(e)},on:{click:function(n){t.switchNav(e)}}},[t._v(t._s(e.name))])])}))],1)])]),t._v(" "),n("div",{staticClass:"panel-body tab-content"},[n("div",{staticClass:"navbarRadio"},t._l(t.CurrentNavigation.filterEntities.timelimit,function(e){return n("label",[n("input",{attrs:{type:"radio",name:"timelimit_"+t._uid},domProps:{checked:t.isActiveTimelimitFilter(e)},on:{click:function(n){t.switchTimelimitFilter(e)}}}),t._v(t._s(e.name)+"\n            ")])})),t._v(" "),n("div",{ref:"chartContainer",staticClass:"tab-pane active"},[t._v("图表区域")])])])},staticRenderFns:[]}},195:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(103),a=n.n(i),r=n(104),s=n.n(r),o=n(191),l=n.n(o);e.default={name:"datapanel-effectives",data:function(){return{navigation:[{name:"职能满编率",code:"13",filters:{timelimit:["lastmonth"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null},{name:"电销转正人数",code:"7",filters:{timelimit:["all"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null},{name:"代理商战斗力",code:"10",filters:{timelimit:["all"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null},{name:"渠道拜访量",code:"54",filters:{timelimit:["today","lastmonth"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null},{name:"人均在线时长",code:"49",filters:{timelimit:["today","lastmonth","monthly"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null,numCallback:function(t,e){this.todayNum=Highcharts.dateFormat("%H:%M:%S",t.num||0)}},{name:"人均有效通话次数",code:"74",filters:{timelimit:["today","lastmonth","monthly"]},todayNum:0,yesterdayNum:0,ratioNum:0,ratioTrend:null}],navigation_monthly:[{name:"销售整体",code:"345",filters:{timelimit:["weekly","monthly"]}},{name:"电销新签",code:"332",filters:{timelimit:["weekly","monthly"]}},{name:"电销增值",code:"333",filters:{timelimit:["weekly","monthly"]}},{name:"渠道",code:"184",filters:{timelimit:["weekly","monthly"]}}],navigation_yearly:[{name:"电销",code:"178"},{name:"渠道",code:"182"}],timerMillisec:66e4,service:{url:"/dataweb/fightchart"}}},created:function(){var t=this;setTimeout(function(){t.render()}),t.renderTimer=window.setInterval(function(){t.render()},t.timerMillisec),window.VueEntity=this},beforeDestroy:function(){var t=this;window.clearInterval(t.renderTimer)},mounted:function(){var t=this;t.$refs.chartTendencyElement.$on("dataReady",function(t){this.CurrentNavigation.code}),t.$refs.chartTendencyElement.$on("beforeRedraw",function(t){49==this.CurrentNavigation.code?(t.series.forEach(function(t,e){t.update({yAxis:0},!1)}),t.yAxis[0].update({title:{text:null},labels:{formatter:function(){var t=this,e=Highcharts.dateFormat("%M:%S",t.value);return("00"+parseInt(t.value/36e5)).slice(-2)+":"+e}}},!1),t.update({tooltip:{shared:!0,formatter:function(){var t='<span style="font-size: 10px">'+this.x+"</span><br>";return this.points.forEach(function(e,n,i){t+='<span style="color:'+e.color+'">●</span>',t+="<tspan> "+e.series.name+": </tspan>",t+='<tspan style="font-weight:bold">'+("00"+parseInt(e.y/36e5)).slice(-2)+":"+Highcharts.dateFormat("%M:%S",e.y)+"</tspan><br>"}),t}}},!1)):t.update({tooltip:{formatter:null}},!1),74==this.CurrentNavigation.code&&t.series.forEach(function(t,e){t.update({yAxis:0},!1)})}),t.$refs.chartTendencyElement_monthly.$on("beforeRender",function(e){180==this.CurrentNavigation.code?t.changeSaleOptions(e):t.changeChannelOptions(e)}),t.$refs.chartTendencyElement_monthly.$on("beforeRedraw",function(e){180==this.CurrentNavigation.code?t.changeSaleSeries(e):t.changeChannelSeries(e)}),t.$refs.navigation_yearly.$on("beforeRedraw",function(t){"178"===this.CurrentNavigation.code&&t.series.forEach(function(t,e){t.update({yAxis:0},!1)})})},methods:{render:function(){var t=this;t.getData().then(function(e){var n=function(t){var e={};return t.forEach(function(t,n){e[t.name]=t}),e},i=function(t){return(t.toString().split(".")[1]||"").length},a=function(t,e){var n=this,a=!1,r=new RegExp("%$","i");a=r.test(t.num)&&r.test(e.num),a?(n.todayNum=(parseFloat(t.num)||0)+"%",n.yesterdayNum=(parseFloat(e.num)||0)+"%",n.ratioNum=((parseFloat(t.num)||0)-(parseFloat(e.num)||0)).toFixed(2)):(n.todayNum=parseFloat(t.num)||0,n.yesterdayNum=parseFloat(e.num)||0,n.ratioNum=((n.todayNum-n.yesterdayNum)/n.yesterdayNum*100||0).toFixed(2),isFinite(((n.todayNum-n.yesterdayNum)/n.yesterdayNum*100||0).toFixed(2))||(n.ratioNum=100),n.todayNum=Highcharts.numberFormat(n.todayNum,i(n.todayNum),".",","),n.yesterdayNum=Highcharts.numberFormat(n.yesterdayNum,i(n.yesterdayNum),".",",")),n.ratioTrend=n.ratioNum>=0,n.ratioNum=Math.abs(n.ratioNum)+"%",n.numCallback&&n.numCallback.call(n,t,e)},r=n(e.yesterdaydata||{}||[]),s=n(e.todaydata||{}||[]);t.navigation.forEach(function(t,e){a.call(t,s[t.name]||{},r[t.name]||{})})})},getData:function(){var t=this;return new s.a(function(e,n){t.$http.get("/dataweb/fightdata",{}).then(function(t){if(t=t.body||{},0!==parseInt(t.errno))return console.warn("返回数据状态码错误！"),void n(t);e(t.data||{})},function(t){console.warn("获取数据请求失败！"),n(t)})})},changeSaleOptions:function(t){a()(t,{chart:{type:"column"},colors:["#4572A7","#bb7c2c","#89A54E"],tooltip:{shared:!0,formatter:function(){var t=this,e="<b>"+this.x+"</b><br/>",n=function(e){var n=t.points.filter(function(t){return e.includes(t.series.name)});return 2==n.length?n[0].y+n[1].y:0};return this.points.forEach(function(t,i){var a=t.series.name,r=["电销整体","电销新签","电销增值"],s=t.y;if(r.includes(a)){if("电销整体"==a&&0==s)s=n(["电销新签","电销增值"]);else if(0==s)return;a+="预估值"}else if("电销整体实际值"==a&&0==s)s=n(["电销新签实际值","电销增值实际值"]);else if(0==s)return;e+=a+":"+s+"元<br/>"},this),e}},plotOptions:{column:{stacking:"normal"}}})},changeSaleSeries:function(t){t.series.forEach(function(t,e){var n=[{stackname:"budgetValue",des:"预算值",color:"#7d6f4c"},{stackname:"forecasts",des:"预估值"},{stackname:"actualValue",des:"实际值"}],i=n.find(function(e){return t.name.indexOf(e.des)>=0}),a="forecasts"===i.stackname,r=t.name.replace(/预估值/g,"");t.update({yAxis:0,stack:i.stackname,color:i.color,name:r,showInLegend:a,events:{legendItemClick:function(t){var e=t.target.chart.series.filter(function(t){return t.name==r+"实际值"||t.name==r+"预算值"});e.length>=0&&e.forEach(function(t){t.visible?t.hide():t.show()})}}},!1)})},changeChannelOptions:function(t){a()(t,{plotOptions:{column:{stacking:"normal"}},chart:{type:"column"},colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],tooltip:{shared:!0,formatter:function(){for(var t=this,e=0,n=0,i=['<span style="font-size: 10px;">'+t.x+"</span><br>"],a=0;a<t.points.length;a++)i=i.concat(['<span style="color:'+t.points[a].color+'">●</span>',"<tspan> "+t.points[a].series.name+": </tspan>",'<tspan style="font-weight:bold">'+t.points[a].y+" 元</tspan><br/>"]),!e&&t.points[a].series.name.includes("实际值")&&(e=t.points[a].total),!n&&t.points[a].series.name.includes("预估值")&&(n=t.points[a].total);return 0!==n&&(i=i.concat(["<span>●</span>","<tspan> 完成: </tspan>",'<tspan style="font-weight:bold">'+(e/n*100).toFixed(2)+"%</tspan>"])),i.join("")}}})},changeChannelSeries:function(t){for(var e=[97,122],n=[],i=[],a=e[0];a<=e[1];a++)n.push(a);i=String.fromCharCode.apply(null,n).split(""),t.series.forEach(function(t,e){t.update({yAxis:0,stack:i[e]},!1)})}},components:{"chart-tendency":l.a}}},220:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-view",attrs:{id:"key-indicators-container"}},[n("div",{staticClass:"padding-md clearfix paddTop50"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"panel panel-default hour-trend"},[t._m(0),t._v(" "),n("div",{staticClass:"panel-body tab-content mTop20"},[n("div",{staticClass:"data3Box"},[t._m(1),t._v(" "),n("div",{staticClass:"data3BoxBot"},[n("div",{staticClass:"data3BoxBotCon"},[n("ul",t._l(t.navigation,function(e){return t.$privileges.user[(t.$privileges.mapping[e.name]||{}).id]?n("li",[n("div",{staticClass:"data3BoxBotList"},[n("dl",[n("dt",[t._v(t._s(e.name))]),t._v(" "),n("dd",[n("span",{staticClass:"l-02"},[t._v(t._s(e.todayNum))]),t._v(" "),n("span",{staticClass:"l-03",class:{"icon-tt-up":e.ratioTrend,"icon-tt-lower":!1===e.ratioTrend}},[t._v(t._s(e.ratioNum))])])])])]):t._e()}))])])]),t._v(" "),n("chart-tendency",{ref:"chartTendencyElement",attrs:{navigation:t.navigation,timermillisec:t.timerMillisec,service:t.service}}),t._v(" "),n("chart-tendency",{ref:"chartTendencyElement_monthly",attrs:{navigation:t.navigation_monthly,timermillisec:t.timerMillisec,service:t.service,chartTitle:"销售预测"}}),t._v(" "),n("chart-tendency",{ref:"navigation_yearly",attrs:{navigation:t.navigation_yearly,timermillisec:t.timerMillisec,service:t.service,chartTitle:"销售业绩趋势"}})],1)])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{staticClass:"navbar navbar-default",attrs:{role:"navigation"}},[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"navbar-header"},[n("span",{staticClass:"navbar-brand"},[t._v("战斗力")])])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"data3BoxTop"},[n("div",{staticClass:"data3BoxTopCon"},[n("dl",[n("dd",[n("span",{staticClass:"l-01"},[t._v(" ")]),t._v(" "),n("span",{staticClass:"l-02"},[t._v("战斗力")]),t._v(" "),n("span",{staticClass:"l-03"},[t._v(" ")])])])]),t._v(" "),n("div",{staticClass:"data3BoxTopArrow"},[n("img",{attrs:{src:"static/img/arrow.png"}})])])}]}}});